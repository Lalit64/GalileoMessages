import{S as a,i as t,s,e,c as l,a as i,d as r,b as c,f as n,I as o,J as h,t as u,k as f,g as d,n as v,K as m,H as g,L as p,h as w,M as $,N as b,j as x,m as E,o as y,x as U,u as T,v as B,O as I,P as A,Q as D,R as L,T as z,l as M,U as O,V,W as N}from"../chunks/vendor-64a9a846.js";import{s as k,A as P}from"../chunks/Auth-e1bd9dcf.js";function _(a){let t,s,o,h,b,x,E,y,U,T=a[1]?"Uploading ...":"Upload";return{c(){t=e("div"),s=u("Please Upload an image to use"),o=f(),h=e("label"),b=u(T),x=f(),E=e("input"),this.h()},l(a){t=l(a,"DIV",{class:!0,style:!0});var e=i(t);s=d(e,"Please Upload an image to use"),e.forEach(r),o=v(a),h=l(a,"LABEL",{class:!0,for:!0});var c=i(h);b=d(c,T),c.forEach(r),x=v(a),E=l(a,"INPUT",{accept:!0,id:!0,style:!0,type:!0}),this.h()},h(){c(t,"class","avatar"),m(t,"height",a[0]),m(t,"width",a[0]),c(h,"class","button primary block svelte-1v99wpu"),c(h,"for","single"),c(E,"accept","image/*"),E.disabled=a[1],c(E,"id","single"),m(E,"visibility","hidden"),m(E,"position","absolute"),c(E,"type","file")},m(e,l){n(e,t,l),g(t,s),n(e,o,l),n(e,h,l),g(h,b),n(e,x,l),n(e,E,l),y||(U=[p(E,"change",a[8]),p(E,"change",a[3])],y=!0)},p(a,s){1&s&&m(t,"height",a[0]),1&s&&m(t,"width",a[0]),2&s&&T!==(T=a[1]?"Uploading ...":"Upload")&&w(b,T),2&s&&(E.disabled=a[1])},d(a){a&&r(t),a&&r(o),a&&r(h),a&&r(x),a&&r(E),y=!1,$(U)}}}function j(a){let t,s,o,h,x,E,y,U,T,B,I,A,D,L,z=a[1]?"Loading...":"Upload",M=a[1]?"Loading...":"Delete";return{c(){t=e("div"),s=e("img"),h=f(),x=e("div"),E=e("label"),y=u(z),U=f(),T=e("button"),B=u(M),I=f(),A=e("input"),this.h()},l(a){t=l(a,"DIV",{class:!0});var e=i(t);s=l(e,"IMG",{src:!0,style:!0,class:!0}),h=v(e),x=l(e,"DIV",{class:!0});var c=i(x);E=l(c,"LABEL",{class:!0,for:!0});var n=i(E);y=d(n,z),n.forEach(r),U=v(c),T=l(c,"BUTTON",{class:!0});var o=i(T);B=d(o,M),o.forEach(r),c.forEach(r),e.forEach(r),I=v(a),A=l(a,"INPUT",{accept:!0,id:!0,style:!0,type:!0}),this.h()},h(){b(s.src,o=a[5].publicURL)||c(s,"src",o),m(s,"height",a[0]),m(s,"width",a[0]),c(s,"class","mb-8 avatar  svelte-1v99wpu"),c(E,"class","button primary block cursor-pointer svelte-1v99wpu"),c(E,"for","single"),c(T,"class","button svelte-1v99wpu"),c(x,"class","flex"),c(t,"class","w-full h-full flex flex-col items-center"),c(A,"accept","image/*"),A.disabled=a[1],c(A,"id","single"),m(A,"visibility","hidden"),m(A,"position","absolute"),c(A,"type","file")},m(e,l){n(e,t,l),g(t,s),g(t,h),g(t,x),g(x,E),g(E,y),g(x,U),g(x,T),g(T,B),n(e,I,l),n(e,A,l),D||(L=[p(T,"click",a[4]),p(A,"change",a[7]),p(A,"change",a[3])],D=!0)},p(a,t){1&t&&m(s,"height",a[0]),1&t&&m(s,"width",a[0]),2&t&&z!==(z=a[1]?"Loading...":"Upload")&&w(y,z),2&t&&M!==(M=a[1]?"Loading...":"Delete")&&w(B,M),2&t&&(A.disabled=a[1])},d(a){a&&r(t),a&&r(I),a&&r(A),D=!1,$(L)}}}function C(a){let t;let s=(a[5].publicURL?j:_)(a);return{c(){t=e("div"),s.c(),this.h()},l(a){t=l(a,"DIV",{class:!0});var e=i(t);s.l(e),e.forEach(r),this.h()},h(){c(t,"class","all svelte-1v99wpu")},m(a,e){n(a,t,e),s.m(t,null)},p(a,[t]){s.p(a,t)},i:o,o:o,d(a){a&&r(t),s.d()}}}function R(a,t,s){let e,{path:l}=t,{size:i="10em"}=t,r=!1;const c=h();const{data:n,error:o}=k.storage.from("avatars").getPublicUrl(`avatars/${k.auth.user().id}`);return a.$$set=a=>{"path"in a&&s(6,l=a.path),"size"in a&&s(0,i=a.size)},[i,r,e,async function(){try{if(s(1,r=!0),!e||0===e.length)throw new Error("You must select an image to upload.");const a=e[0],t=`${`${k.auth.user().id}`}`;let{error:i}=await k.storage.from("avatars").upload(`avatars/${t}`,a);if(i)throw i;s(6,l=t),c("upload")}catch(a){alert(a.message)}finally{s(1,r=!1),location.reload()}},async()=>{await k.storage.from("avatars").remove(["avatars/4ce7bb49-7397-4f5b-a104-5736f83b113f"]),location.reload()},n,l,function(){e=this.files,s(2,e)},function(){e=this.files,s(2,e)}]}class S extends a{constructor(a){super(),t(this,a,R,C,s,{path:6,size:0})}}function G(a){let t,s,h;return s=new S({}),{c(){t=e("div"),x(s.$$.fragment),this.h()},l(a){t=l(a,"DIV",{class:!0});var e=i(t);E(s.$$.fragment,e),e.forEach(r),this.h()},h(){c(t,"class","settings svelte-1golne8")},m(a,e){n(a,t,e),y(s,t,null),h=!0},p:o,i(a){h||(U(s.$$.fragment,a),h=!0)},o(a){T(s.$$.fragment,a),h=!1},d(a){a&&r(t),B(s)}}}class H extends a{constructor(a){super(),t(this,a,null,G,s,{})}}function q(a){let t,s,h;return{c(){t=e("div"),s=I("svg"),h=I("path"),this.h()},l(a){t=l(a,"DIV",{class:!0});var e=i(t);s=A(e,"svg",{class:!0,width:!0,height:!0,fill:!0,focusable:!0,viewBox:!0,"aria-hidden":!0});var c=i(s);h=A(c,"path",{d:!0}),i(h).forEach(r),c.forEach(r),e.forEach(r),this.h()},h(){c(h,"d","M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"),c(s,"class","MuiSvgIcon-root MuiAvatar-fallback"),c(s,"width","30"),c(s,"height","30"),c(s,"fill","white"),c(s,"focusable","false"),c(s,"viewBox","0 0 24 24"),c(s,"aria-hidden","true"),c(t,"class","MuiAvatar-root MuiAvatar-circular MuiAvatar-colorDefault svelte-1xim3ew")},m(a,e){n(a,t,e),g(t,s),g(s,h)},p:o,d(a){a&&r(t)}}}function F(a){let t,s;return{c(){t=e("img"),this.h()},l(a){t=l(a,"IMG",{src:!0,class:!0}),this.h()},h(){b(t.src,s=a[4])||c(t,"src",s),c(t,"class","svelte-1xim3ew")},m(a,s){n(a,t,s)},p:o,d(a){a&&r(t)}}}function J(a){let t,s,h,m,w,b,x,E,y,U,T;return{c(){t=e("div"),s=e("button"),h=u("New Chat"),m=f(),w=e("button"),b=u("Settings"),x=f(),E=e("button"),y=u("Log out"),this.h()},l(a){t=l(a,"DIV",{class:!0});var e=i(t);s=l(e,"BUTTON",{class:!0});var c=i(s);h=d(c,"New Chat"),c.forEach(r),m=v(e),w=l(e,"BUTTON",{class:!0,id:!0});var n=i(w);b=d(n,"Settings"),n.forEach(r),x=v(e),E=l(e,"BUTTON",{class:!0});var o=i(E);y=d(o,"Log out"),o.forEach(r),e.forEach(r),this.h()},h(){c(s,"class","list svelte-1xim3ew"),c(w,"class","list svelte-1xim3ew"),c(w,"id","settings"),c(E,"class","list l svelte-1xim3ew"),c(t,"class","menu pt-2 pb-2 flex flex-col svelte-1xim3ew")},m(e,l){n(e,t,l),g(t,s),g(s,h),g(t,m),g(t,w),g(w,b),g(t,x),g(t,E),g(E,y),U||(T=[p(w,"click",a[7]),p(E,"click",a[8])],U=!0)},p:o,d(a){a&&r(t),U=!1,$(T)}}}function K(a){var t;let s,o,h=null==(t=k.auth.user())?void 0:t.email,u=h&&function(a){let t,s,o,h,u,d,m,w,b,M,V,N,k,P,_,j,C,R,S,G,K,Q,W,Y,X,Z,aa,ta,sa;m=new H({});let ea=(a[4]?F:q)(a);return Z=new O({props:{class:"menutop",anchorCorner:"BOTTOM_LEFT",$$slots:{default:[J]},$$scope:{ctx:a}}}),a[9](Z),{c(){t=e("div"),s=e("div"),o=e("button"),h=I("svg"),u=I("path"),d=f(),x(m.$$.fragment),w=f(),b=e("div"),M=e("div"),V=e("div"),ea.c(),N=f(),k=e("div"),P=e("button"),_=I("svg"),j=I("path"),C=f(),R=e("button"),S=I("svg"),G=I("path"),K=f(),Q=e("button"),W=I("svg"),Y=I("path"),X=f(),x(Z.$$.fragment),this.h()},l(a){t=l(a,"DIV",{class:!0});var e=i(t);s=l(e,"DIV",{class:!0});var c=i(s);o=l(c,"BUTTON",{class:!0});var n=i(o);h=A(n,"svg",{viewBox:!0,width:!0});var f=i(h);u=A(f,"path",{class:!0,d:!0}),i(u).forEach(r),f.forEach(r),n.forEach(r),d=v(c),E(m.$$.fragment,c),c.forEach(r),w=v(e),b=l(e,"DIV",{class:!0});var g=i(b);M=l(g,"DIV",{class:!0});var p=i(M);V=l(p,"DIV",{class:!0});var $=i(V);ea.l($),$.forEach(r),N=v(p),k=l(p,"DIV",{class:!0});var x=i(k);P=l(x,"BUTTON",{class:!0});var y=i(P);_=A(y,"svg",{viewBox:!0,width:!0,height:!0,class:!0});var U=i(_);j=A(U,"path",{fill:!0,d:!0}),i(j).forEach(r),U.forEach(r),y.forEach(r),C=v(x),R=l(x,"BUTTON",{class:!0});var T=i(R);S=A(T,"svg",{viewBox:!0,width:!0,height:!0,class:!0});var B=i(S);G=A(B,"path",{fill:!0,d:!0}),i(G).forEach(r),B.forEach(r),T.forEach(r),K=v(x),Q=l(x,"BUTTON",{class:!0});var I=i(Q);W=A(I,"svg",{viewBox:!0,width:!0,height:!0,class:!0});var D=i(W);Y=A(D,"path",{fill:!0,d:!0}),i(Y).forEach(r),D.forEach(r),I.forEach(r),X=v(x),E(Z.$$.fragment,x),x.forEach(r),p.forEach(r),g.forEach(r),e.forEach(r),this.h()},h(){c(u,"class","close-x svelte-1xim3ew"),c(u,"d","M 10,10 L 30,30 M 30,10 L 10,30"),c(h,"viewBox","0 0 40 40"),c(h,"width","11"),c(o,"class","close svelte-1xim3ew"),c(s,"class","sidebar drawer svelte-1xim3ew"),D(s,"shown",a[1]),c(V,"class","avatar svelte-1xim3ew"),c(j,"fill","currentColor"),c(j,"d","M12 7a2 2 0 1 0-.001-4.001A2 2 0 0 0 12 7zm0 2a2 2 0 1 0-.001 3.999A2 2 0 0 0 12 9zm0 6a2 2 0 1 0-.001 3.999A2 2 0 0 0 12 15z"),c(_,"viewBox","0 0 24 24"),c(_,"width","24"),c(_,"height","24"),c(_,"class",""),c(P,"class","btn svelte-1xim3ew"),c(G,"fill","currentColor"),c(G,"d","M12 7a2 2 0 1 0-.001-4.001A2 2 0 0 0 12 7zm0 2a2 2 0 1 0-.001 3.999A2 2 0 0 0 12 9zm0 6a2 2 0 1 0-.001 3.999A2 2 0 0 0 12 15z"),c(S,"viewBox","0 0 24 24"),c(S,"width","24"),c(S,"height","24"),c(S,"class",""),c(R,"class","btn svelte-1xim3ew"),c(Y,"fill","currentColor"),c(Y,"d","M12 7a2 2 0 1 0-.001-4.001A2 2 0 0 0 12 7zm0 2a2 2 0 1 0-.001 3.999A2 2 0 0 0 12 9zm0 6a2 2 0 1 0-.001 3.999A2 2 0 0 0 12 15z"),c(W,"viewBox","0 0 24 24"),c(W,"width","24"),c(W,"height","24"),c(W,"class",""),c(Q,"class","btn svelte-1xim3ew"),c(k,"class","icons items-center absolute right-4 w-2/6 h-full flex justify-between"),c(M,"class","header svelte-1xim3ew"),c(b,"class","sidebar svelte-1xim3ew"),c(t,"class","screen flex")},m(e,l){n(e,t,l),g(t,s),g(s,o),g(o,h),g(h,u),g(s,d),y(m,s,null),g(t,w),g(t,b),g(b,M),g(M,V),ea.m(V,null),g(M,N),g(M,k),g(k,P),g(P,_),g(_,j),g(k,C),g(k,R),g(R,S),g(S,G),g(k,K),g(k,Q),g(Q,W),g(W,Y),g(k,X),y(Z,k,null),aa=!0,ta||(sa=[p(o,"click",a[5]),p(Q,"click",a[6]),L(a[2].call(null,M)),p(M,"submit",z(a[3]))],ta=!0)},p(a,t){2&t&&D(s,"shown",a[1]),ea.p(a,t);const e={};65539&t&&(e.$$scope={dirty:t,ctx:a}),Z.$set(e)},i(a){aa||(U(m.$$.fragment,a),U(Z.$$.fragment,a),aa=!0)},o(a){T(m.$$.fragment,a),T(Z.$$.fragment,a),aa=!1},d(s){s&&r(t),B(m),ea.d(),a[9](null),B(Z),ta=!1,$(sa)}}}(a);return{c(){u&&u.c(),s=M()},l(a){u&&u.l(a),s=M()},m(a,t){u&&u.m(a,t),n(a,s,t),o=!0},p(a,[t]){h&&u.p(a,t)},i(a){o||(U(u),o=!0)},o(a){T(u),o=!1},d(a){u&&u.d(a),a&&r(s)}}}function Q(a,t,s){var e=this&&this.__awaiter||function(a,t,s,e){return new(s||(s=Promise))((function(l,i){function r(a){try{n(e.next(a))}catch(t){i(t)}}function c(a){try{n(e.throw(a))}catch(t){i(t)}}function n(a){var t;a.done?l(a.value):(t=a.value,t instanceof s?t:new s((function(a){a(t)}))).then(r,c)}n((e=e.apply(a,t||[])).next())}))};let l,i=!0,r=null,c=null;let n=!1;const{publicURL:o,error:h}=k.storage.from("avatars").getPublicUrl(`avatars/${k.auth.user().id}`);return[l,n,function(){var a;return e(this,void 0,void 0,(function*(){try{i=!0;const t=null===(a=null==k?void 0:k.auth)||void 0===a?void 0:a.user();let{data:s,error:e,status:l}=yield k.from("profiles").select("username, avatar_url").eq("id",t.id).single();if(e&&406!==l)throw e;s&&(r=s.username,c=s.avatar_url)}catch(t){alert(t.message)}finally{i=!1}}))},function(){return e(this,void 0,void 0,(function*(){try{i=!0;const a={id:k.auth.user().id,username:r,avatar_url:c,updated_at:new Date};let{error:t}=yield k.from("profiles").upsert(a,{returning:"minimal"});if(t)throw t}catch(a){alert(a.message)}finally{i=!1}}))},o,()=>{s(1,n=!n)},()=>l.setOpen(!0),()=>{s(1,n=!n),l.setOpen(!1),console.log(n)},()=>{k.auth.signOut().then((()=>{location.reload()}))},function(a){V[a?"unshift":"push"]((()=>{l=a,s(0,l)}))}]}class W extends a{constructor(a){super(),t(this,a,Q,K,s,{})}}function Y(a){let t,s;return t=new P({props:{type:"signin"}}),{c(){x(t.$$.fragment)},l(a){E(t.$$.fragment,a)},m(a,e){y(t,a,e),s=!0},i(a){s||(U(t.$$.fragment,a),s=!0)},o(a){T(t.$$.fragment,a),s=!1},d(a){B(t,a)}}}function X(a){let t,s;return t=new W({}),{c(){x(t.$$.fragment)},l(a){E(t.$$.fragment,a)},m(a,e){y(t,a,e),s=!0},i(a){s||(U(t.$$.fragment,a),s=!0)},o(a){T(t.$$.fragment,a),s=!1},d(a){B(t,a)}}}function Z(a){let t,s,e,l,i;const c=[X,Y],h=[];var u;return s=(null==(u=k.auth.user())?void 0:u.email)?0:1,e=h[s]=c[s](a),{c(){t=f(),e.c(),l=M(),this.h()},l(a){N('[data-svelte="svelte-1hmj2zj"]',document.head).forEach(r),t=v(a),e.l(a),l=M(),this.h()},h(){document.title="\n\t\tGalileoMessages | Home\n\t"},m(a,e){n(a,t,e),h[s].m(a,e),n(a,l,e),i=!0},p:o,i(a){i||(U(e),i=!0)},o(a){T(e),i=!1},d(a){a&&r(t),h[s].d(a),a&&r(l)}}}function aa(a){return[]}class ta extends a{constructor(a){super(),t(this,a,aa,Z,s,{})}}export{ta as default};
